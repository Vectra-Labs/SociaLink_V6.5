<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SociaLink - Rapport Technique D√©tail√©</title>
    <link rel="stylesheet" href="style.css">
    <script type="module">
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        mermaid.initialize({ startOnLoad: true, theme: 'neutral' });
    </script>
</head>
<body>

    <header>
        <h1>RAPPORT TECHNIQUE APPROFONDI<br><small>Projet SociaLink v6.5</small></h1>
        <p style="text-align: center; font-size: 1.2rem; color: #64748b;">
            D√©veloppement Full-Stack MERN ‚Ä¢ Architecture ‚Ä¢ S√©curit√© ‚Ä¢ Logique M√©tier
        </p>
    </header>

    <div class="toc no-print">
        <h3>Sommaire Rapide</h3>
        <ul>
            <li><a href="#chapitre-1-architecture">1. Architecture & Environnement</a></li>
            <li><a href="#chapitre-2-backend">2. Backend API & REST</a></li>
            <li><a href="#chapitre-3-database">3. Base de Donn√©es (Prisma)</a></li>
            <li><a href="#securite-avancee">4. S√©curit√© Avanc√©e</a></li>
            <li><a href="#frontend-details">5. Frontend & State</a></li>
            <li><a href="#chapitre-6-deploy">6. D√©ploiement & DevOps</a></li>
        </ul>
    </div>

    <!-- CHAPITRE 1 -->
    <section id="chapitre-1-architecture">
        <h2>Chapitre 1 : Architecture & Environnement Technique</h2>
        
        <div class="intro-block">
            <p>La r√©ussite d'un projet web d'envergure repose avant tout sur des fondations solides. Pour <strong>SociaLink v6.5</strong>, nous avons opt√© pour une architecture modulaire, s√©parant distinctement la logique m√©tier (Backend) de l'interface utilisateur (Frontend). Cette s√©paration garantit la maintanabilit√© du code et facilite le travail collaboratif.</p>
        </div>

        <h3>1.1 Stack Technologique (MERN √âvolu√©e)</h3>
        <p>Nous avons s√©lectionn√© des technologies √©prouv√©es mais modernes (Versions 2026) pour assurer performance et long√©vit√©.</p>
        
        <table class="tech-table">
            <thead>
                <tr>
                    <th>Couche</th>
                    <th>Technologie</th>
                    <th>Version</th>
                    <th>Justification du Choix</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Frontend</strong></td>
                    <td>React.js + Vite</td>
                    <td>v19.2 / v7.2</td>
                    <td>React 19 apporte une meilleure gestion du rendu concurrent. Vite remplace Create-React-App pour des temps de d√©marrage instantan√©s.</td>
                </tr>
                <tr>
                    <td><strong>Styling</strong></td>
                    <td>Tailwind CSS</td>
                    <td>v4.1</td>
                    <td>Approche "Utility-First" permettant un prototypage ultra-rapide et un design system coh√©rent sans fichiers CSS lourds.</td>
                </tr>
                <tr>
                    <td><strong>Backend</strong></td>
                    <td>Node.js + Express</td>
                    <td>v22 / v5.2</td>
                    <td>Express 5 g√®re nativement les promesses (Promises), simplifiant la gestion des erreurs asynchrones.</td>
                </tr>
                <tr>
                    <td><strong>Base de Donn√©es</strong></td>
                    <td>PostgreSQL + Prisma</td>
                    <td>v16 / v6.19</td>
                    <td>SQL garantit l'int√©grit√© des donn√©es relationnelles. Prisma offre une s√©curit√© de type (Type-Safety) in√©gal√©e.</td>
                </tr>
                <tr>
                    <td><strong>Validation</strong></td>
                    <td>Zod</td>
                    <td>v3.25</td>
                    <td>Validation stricte des donn√©es entrantes (Schema Validation) pour √©viter les injections et erreurs de format.</td>
                </tr>
            </tbody>
        </table>

        <h3>1.2 Architecture du Backend (D√©tail)</h3>
        <p>Le backend est structur√© selon le pattern <strong>MVC (Model-View-Controller)</strong> adapt√© aux API REST. Chaque dossier a une responsabilit√© unique.</p>
        
        <div class="card">
            <div class="tree-view">
/backend/src
‚îú‚îÄ‚îÄ config/             # Configuration globale
‚îÇ   ‚îî‚îÄ‚îÄ db.js           # Instance unique du client Prisma (Singleton)
‚îú‚îÄ‚îÄ controllers/        # ORCHESTRATION (Le "Chef d'Orchestre")
‚îÇ   ‚îú‚îÄ‚îÄ authController.js       # Logique d'inscription, login, v√©rification email
‚îÇ   ‚îú‚îÄ‚îÄ workerController.js     # Logique de matching et recherche
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ middleware/         # S√âCURIT√â (Les "Gardes du Corps")
‚îÇ   ‚îú‚îÄ‚îÄ authMiddleware.js       # D√©crypte le token JWT
‚îÇ   ‚îú‚îÄ‚îÄ roleMiddleware.js       # V√©rifie si l'user est ADMIN/WORKER
‚îÇ   ‚îî‚îÄ‚îÄ uploadMiddleware.js     # Filtre les fichiers (Multer: PDF/JPG uniquement)
‚îú‚îÄ‚îÄ routes/             # AIGUILLAGE (Le "GPS")
‚îÇ   ‚îî‚îÄ‚îÄ authRoutes.js           # Mappe l'URL /login vers authController.login
‚îú‚îÄ‚îÄ services/           # M√âTIER COMPLEXE (Les "Experts")
‚îÇ   ‚îú‚îÄ‚îÄ encryptionService.js    # Chiffrement AES-256 des fichiers
‚îÇ   ‚îú‚îÄ‚îÄ emailService.js         # Envoi SMTP
‚îÇ   ‚îî‚îÄ‚îÄ notificationService.js  # Gestion des Sockets Temps-r√©el
‚îî‚îÄ‚îÄ validators/         # CONTR√îLE QUALIT√â (Le "Douanier")
    ‚îî‚îÄ‚îÄ authValidator.js        # Sch√©mas Zod (Password complexity, Email format)
            </div>
            <p><strong>Flux d'une requ√™te :</strong> <code>Route</code> -> <code>Validator</code> -> <code>Middleware</code> -> <code>Controller</code> -> <code>Service</code> -> <code>Database</code>.</p>
        </div>

        <h3>1.3 Architecture du Frontend (D√©tail)</h3>
        <p>Le frontend React n'est pas une simple coquille vide. Il g√®re une complexit√© logique importante (√âtat, Cache, Navigation).</p>

        <div class="card">
            <div class="tree-view">
/frontend/src
‚îú‚îÄ‚îÄ api/                # COUCHE R√âSEAU
‚îÇ   ‚îî‚îÄ‚îÄ client.js       # Instance Axios avec Intercepteurs (Gestion auto des 401)
‚îú‚îÄ‚îÄ components/         # BRIQUES LEGO (UI)
‚îÇ   ‚îú‚îÄ‚îÄ common/         # Boutons, Inputs, Modal (R√©utilisables partout)
‚îÇ   ‚îú‚îÄ‚îÄ layout/         # Navbar, Sidebar, Footer (Structure des pages)
‚îÇ   ‚îî‚îÄ‚îÄ specific/       # Composants m√©tier (ex: MissionCard)
‚îú‚îÄ‚îÄ context/            # M√âMOIRE GLOBALE
‚îÇ   ‚îú‚îÄ‚îÄ AuthContext.jsx         # Qui est connect√© ? (User, Role)
‚îÇ   ‚îî‚îÄ‚îÄ SocketContext.jsx       # Canal de communication temps-r√©el
‚îú‚îÄ‚îÄ hooks/              # LOGIQUE R√âUTILISABLE (Custom Hooks)
‚îÇ   ‚îú‚îÄ‚îÄ useAuth.js              # Acc√®s simplifi√© au contexte Auth
‚îÇ   ‚îî‚îÄ‚îÄ useDebounce.js          # Optimisation de la recherche (√©vite trop de requ√™tes)
‚îú‚îÄ‚îÄ pages/              # √âCRANS DE L'APPLICATION
‚îÇ   ‚îú‚îÄ‚îÄ public/         # Home, Login, Register
‚îÇ   ‚îú‚îÄ‚îÄ worker/         # Dashboard Travailleur (Prot√©g√©)
‚îÇ   ‚îî‚îÄ‚îÄ admin/          # Dashboard Admin (Prot√©g√©)
‚îî‚îÄ‚îÄ services/           # POINTS D'ENTR√âE API
    ‚îî‚îÄ‚îÄ auth.service.js # Fonctions async (login, register...)
            </div>
        </div>

        <h3>1.4 Flux de Donn√©es Global (Data Flow)</h3>
        <p>Comprendre comment les donn√©es voyagent est essentiel. Voici le trajet d'une donn√©e critique (ex: Mot de passe lors de l'inscription).</p>

        <div class="mermaid">
        sequenceDiagram
            participant User as Utilisateur
            participant React as Frontend (Vite)
            participant Axios as Client API
            participant Express as Backend (Node)
            participant Prisma as ORM
            participant PG as PostgreSQL DB

            User->>React: Remplit le formulaire
            React->>React: Validation Zod (C√¥t√© Client)
            React->>Axios: Envoie POST /api/register
            Axios->>Express: Requ√™te HTTP (JSON)
            Express->>Express: Validation Zod (C√¥t√© Serveur)
            Express->>Prisma: Hash Password (Bcrypt)
            Prisma->>PG: INSERT INTO users
            PG-->>Prisma: Confirm ID
            Prisma-->>Express: User Created
            Express-->>Axios: 201 Created (Success)
            Axios-->>React: Update UI (Redirect to Login)
            React-->>User: Affiche "Inscription r√©ussie"
        </div>
    </section>

    <!-- CHAPITRE 2 -->
    <section id="chapitre-2-backend">
        <h2>Chapitre 2 : Backend API & Principes REST</h2>
        <div class="intro-block">
            <p>Notre backend Express.js n'est pas un simple passe-plat. Il impl√©mente une logique rigoureuse de s√©curit√© et de validation pour garantir que chaque donn√©e entrant dans la base est propre et autoris√©e.</p>
        </div>

        <h3>2.1 Organisation des Routes (RESTful)</h3>
        <p>Nous respectons les verbes HTTP standards pour chaque action. Voici un extrait r√©el de <code>workerRoutes.js</code> montrant cette organisation :</p>

        <pre><code class="language-javascript">
// backend/src/routes/workerRoutes.js
const router = express.Router();

// Middleware Global pour ce fichier :
// 1. √ätre connect√© (Auth)
// 2. √ätre un Travailleur (Role)
router.use(authMiddleware, roleMiddleware("WORKER"));

// Lecture (GET)
router.get("/profile", getWorkerProfile);
router.get("/stats", getWorkerStats);

// √âcriture (POST)
router.post("/experience", addExperience);

// Mise √† jour (PUT) - Upload de fichiers inclus
router.put("/profile/update", 
    uploadImage.fields([{ name: 'photo' }, { name: 'banner' }]), 
    validate(updateWorkerProfileSchema), // Validation Zod ici
    updateWorkerProfile
);

// Suppression (DELETE)
router.delete("/experience/:id", deleteExperience);
        </code></pre>

        <h3>2.2 La Cha√Æne de Middleware (Le Pipeline de S√©curit√©)</h3>
        <p>Avant qu'une requ√™te n'atteigne le contr√¥leur (la fonction qui fait le travail), elle doit traverser plusieurs barri√®res de s√©curit√©. Si une seule √©choue, la requ√™te est rejet√©e imm√©diatement.</p>

        <div class="mermaid">
        graph LR
            Req[Requ√™te Client] --> Auth{Auth Middleware<br/>Token Valide ?}
            Auth -- Non --> 401[401 Unauthorized]
            Auth -- Oui --> Role{Role Middleware<br/>Est WORKER ?}
            Role -- Non --> 403[403 Forbidden]
            Role -- Oui --> Upload{Multer<br/>Fichier OK ?}
            Upload -- Non --> 400A[400 Bad Request<br/>Format invalide]
            Upload -- Oui --> Zod{Validator Zod<br/>Donn√©es valides ?}
            Zod -- Non --> 400B[400 Bad Request<br/>Erreur de champs]
            Zod -- Oui --> Controller[Worker Controller]
            Controller --> DB[(Database)]
            
            style Auth fill:#fecaca,stroke:#dc2626
            style Role fill:#fecaca,stroke:#dc2626
            style Zod fill:#fde68a,stroke:#d97706
            style Controller fill:#bbf7d0,stroke:#16a34a
        </div>

        <h3>2.3 Logique des Contr√¥leurs (Separation of Concerns)</h3>
        <p>Pour √©viter les "Fat Controllers" (fonctions de 500 lignes), nous d√©l√©guons la logique complexe. Le contr√¥leur ne fait que coordonner.</p>
        
        <p><strong>Exemple : Inscription d'un √©tablissement</strong></p>
        <div class="code-block">
            <pre><code class="language-javascript">
// backend/src/controllers/authController.js

export const registerEstablishment = async (req, res) => {
  try {
    // 1. Les donn√©es sont d√©j√† valid√©es par Zod √† ce stade
    const { email, password, ...profileData } = req.body;

    // 2. Logic m√©tier: Hashage
    const hashedPassword = await bcrypt.hash(password, 10);

    // 3. Transaction SGBD (Atomique)
    // Si la cr√©ation du profil √©choue, l'utilisateur n'est pas cr√©√©
    await prisma.$transaction(async (tx) => {
        const newUser = await tx.user.create({ ... });
        await tx.establishmentProfile.create({ ... });
    });

    // 4. Service Tiers : Envoi Email
    await sendVerificationEmail(email, code);

    // 5. R√©ponse unifi√©e
    res.status(201).json({ status: "success", message: "V√©rifiez votre email" });

  } catch (error) {
    // Gestion d'erreur centralis√©e
    res.status(500).json({ message: "Erreur serveur" });
  }
};
            </code></pre>
        </div>
    </section>

    <!-- CHAPITRE 3 -->
    <section id="chapitre-3-database">
        <h2>Chapitre 3 : Base de Donn√©es & Mod√©lisation</h2>
        <div class="intro-block">
            <p>Le c≈ìur de SociaLink repose sur une base de donn√©es PostgreSQL relationnelle, g√©r√©e via l'ORM Prisma. Ce choix garantit une int√©grit√© des donn√©es stricte (Cl√©s √©trang√®res, Contraintes d'unicit√©) et une s√©curit√© de type au niveau du code (Type-Safety).</p>
        </div>

        <h3>3.1 Sch√©ma Entit√©-Association (Simplifi√©)</h3>
        <p>Le mod√®le de donn√©es est centr√© autour de l'entit√© <code>User</code>, qui se d√©cline en profils sp√©cifiques (Polymorphisme par association).</p>

        <div class="mermaid">
        erDiagram
            User ||--o| WorkerProfile : "has"
            User ||--o| EstablishmentProfile : "has"
            User ||--o{ Notification : "receives"
            
            EstablishmentProfile ||--o{ Mission : "creates"
            WorkerProfile ||--o{ Application : "applies to"
            Mission ||--o{ Application : "receives"
            
            WorkerProfile ||--o{ Review : "receives"
            Mission ||--o{ Review : "has"

            User {
                int id
                string email
                enum role "WORKER, ESTABLISHMENT, ADMIN"
                enum status "PENDING, VALIDATED"
            }
            
            Mission {
                string title
                float budget
                boolean is_urgent
                enum status "OPEN, CLOSED"
            }
        </div>

        <h3>3.2 Relations Cl√©s et Choix de Conception</h3>
        <ul class="feature-list">
            <li>
                <strong>H√©ritage des Utilisateurs</strong> : Nous n'avons pas fait de tables <code>Workers</code> et <code>Establishments</code> s√©par√©es pour l'authentification. Tout le monde est un <code>User</code> (pour le Login unique), et les d√©tails sp√©cifiques sont dans des tables proflies li√©es en <code>One-to-One</code>.
            </li>
            <li>
                <strong>Int√©grit√© R√©f√©rentielle (Cascade Delete)</strong> : Si un utilisateur supprime son compte, Prisma supprime automatiquement (via <code>onDelete: Cascade</code>) son profil, ses messages, ses notifications et ses candidatures. Cela √©vite les "donn√©es orphelines" qui polluent la base.
            </li>
            <li>
                <strong>Syst√®me d'Abonnement</strong> : Le mod√®le <code>Subscription</code> est li√© √† <code>SubscriptionPlanConfig</code>. Cela permet √† l'administrateur de modifier le prix ou les avantages d'un plan sans toucher au code, juste en modifiant la ligne en base de donn√©es.
            </li>
        </ul>

        <h3>3.3 Strat√©gie de Donn√©es (Seeding & Migrations)</h3>
        <p>Pour garantir que chaque d√©veloppeur (et le serveur de production) a la m√™me structure de base :</p>
        
        <h4>Prisma Migrate</h4>
        <p>Chaque changement de sch√©ma g√©n√®re un fichier SQL immuable. Cela permet de versionner la structure de la BDD avec Git.</p>
        <pre><code class="language-bash">
# Exemple de commande de migration
npx prisma migrate dev --name add_subscription_model
# G√©n√®re: /prisma/migrations/20260203_add_subscription_model/migration.sql
        </code></pre>

        <h4>Seeding (Donn√©es initiales)</h4>
        <p>Le script <code>prisma/seed.js</code> peuple automatiquement la base avec les donn√©es essentielles au d√©marrage de l'application :</p>
        <ul>
            <li><strong>Super Admin</strong> : Cr√©ation du compte administrateur par d√©faut.</li>
            <li><strong>R√©f√©rentiels G√©ographiques</strong> : Injection des 12 R√©gions et principales Villes du Maroc.</li>
            <li><strong>M√©tiers</strong> : Liste pr√©d√©finie des sp√©cialit√©s (Plomberie, Electricit√©...).</li>
        </ul>
    </section>

    <!-- CHAPITRE 4 -->
    <section id="frontend-details">
        <h2>Chapitre 4 : Impl√©mentation Frontend (React)</h2>
        <div class="intro-block">
            <p>Le frontend a √©t√© con√ßu pour √™tre <strong>r√©actif</strong> et <strong>modulaire</strong>. Nous avons r√©solu les probl√®mes classiques de React (prop drilling, re-renders inutiles) gr√¢ce √† une utilisation intelligente des Contexts et des Custom Hooks.</p>
        </div>

        <h3>4.1 Gestion d'√âtat Global (AuthContext)</h3>
        <p>L'√©tat de l'utilisateur (connect√©, r√¥le, avatar) est n√©cessaire partout : dans la Navbar, les routes prot√©g√©es, le dashboard. Pour √©viter de passer les props manuellement √† travers 10 composants (Prop Drilling), nous utilisons l'API Context.</p>
        
        <div class="code-block">
            <h4>Code Source : authContext.jsx (Simplifi√©)</h4>
            <pre><code class="language-javascript">
// frontend/src/context/AuthContext.jsx
export const AuthProvider = ({ children }) => {
    const [user, setUser] = useState(null);
    const [loading, setLoading] = useState(true);

    // Au chargement de l'app, on v√©rifie si un cookie de session existe
    useEffect(() => {
        checkUserLoggedIn();
    }, []);

    const checkUserLoggedIn = async () => {
        try {
            const { data } = await api.get('/auth/me');
            setUser(data.data); 
        } catch (error) {
            setUser(null);
        } finally {
            setLoading(false);
        }
    };

    // Le Provider diffuse l'objet { user, login, logout } √† toute l'app
    return (
        &lt;AuthContext.Provider value={{ user, login, logout, loading }}&gt;
            {!loading && children}
        &lt;/AuthContext.Provider&gt;
    );
};
            </code></pre>
        </div>

        <h3>4.2 Architecture des Composants (Smart vs Dumb)</h3>
        <p>Nous s√©parons nos composants en deux cat√©gories pour faciliter les tests et la r√©utilisation :</p>
        <ul class="feature-list">
            <li>
                <strong>Dumb Components (UI)</strong> : Ne font qu'afficher des donn√©es. Exemple : <code>Button.jsx</code>, <code>MissionCard.jsx</code>. Ils n'ont aucune d√©pendance avec l'API.
            </li>
            <li>
                <strong>Smart Components (Containers)</strong> : G√®rent la logique et les appels API. Exemple : <code>MissionList.jsx</code>. Ils r√©cup√®rent les donn√©es et les passent aux composants UI.
            </li>
        </ul>

        <h3>4.3 Communication API (Axios Interceptors)</h3>
        <p>Plut√¥t que de v√©rifier sur chaque page si le token est expir√©, nous avons centralis√© cette logique directement dans la configuration d'Axios.</p>
        
        <pre><code class="language-javascript">
// frontend/src/api/client.js
api.interceptors.response.use(
    (response) => response,
    (error) => {
        // Si le backend renvoie 401 (Non autoris√©)
        if (error.response?.status === 401) {
            console.warn('Session expir√©e, redirection vers login...');
            // On pourrait ici forcer une d√©connexion automatique
        }
        return Promise.reject(error);
    }
);
        </code></pre>

        <h3>4.4 Temps R√©el (Socket.io)</h3>
        <p>Pour les notifications instantan√©es (ex: "Nouvelle candidature re√ßue"), nous utilisons un <code>SocketContext</code> qui maintient une connexion WebSocket ouverte. D√®s qu'un √©v√©nement survient c√¥t√© serveur, il est "push√©" vers le client sans que l'utilisateur n'ait besoin de rafra√Æchir la page.</p>
    </section>

    <!-- CHAPITRE 5 -->
    <section id="securite-avancee">
        <h2>Chapitre 5 : Syst√®mes de S√©curit√© Avanc√©s</h2>
        <div class="intro-block">
            <p>La s√©curit√© n'est pas une option sur SociaLink. Nous appliquons le principe de "Defense in Depth" (D√©fense en profondeur) avec multiples couches de protection.</p>
        </div>

        <div class="card">
            <h3>üîí 5.1 Validation des Entr√©es (Input Validation)</h3>
            <p>Nous n'utilisons jamais <code>if/else</code> artisanal pour valider les donn√©es. Chaque requ√™te entrante est intercept√©e par un sch√©ma <strong>Zod</strong> strict. Si le format est invalide, le code m√©tier ne s'ex√©cute m√™me pas.</p>
            <pre><code class="language-javascript">
// backend/src/validators/authValidator.js
export const registerWorkerSchema = z.object({
    email: z.string().email("Format invalide"),
    password: z.string()
        .min(8)
        .regex(/[A-Z]/, "Majuscule requise")
        .regex(/[0-9]/, "Chiffre requis"),
    // Zod nettoie automatiquement les champs inconnus (Strip unknown)
});
            </code></pre>
        </div>

        <div class="card">
            <h3>üõ°Ô∏è 5.2 Contr√¥le d'Acc√®s (RBAC)</h3>
            <p>L'acc√®s aux routes est prot√©g√© par une double barri√®re middleware :</p>
            <ol>
                <li><strong>AuthMiddleware</strong> : V√©rifie la validit√© du JWT et l'identit√© de l'user.</li>
                <li><strong>RoleMiddleware</strong> : V√©rifie si le r√¥le de l'user est autoris√© √† acc√©der √† la ressource.</li>
            </ol>
            <p><em>Exemple de protection d'une route sensible :</em></p>
            <pre><code class="language-javascript">
router.delete('/delete-account', 
    protect,              // Barri√®re 1 : Qui est-ce ?
    authorize('ADMIN'),   // Barri√®re 2 : A-t-il le droit ?
    deleteAccount
);
            </code></pre>
        </div>

        <div class="card">
            <h3>üîê 5.3 Cryptage des Documents (AES-256-CBC)</h3>
            <p>Les fichiers sensibles (CNIE, Dipl√¥mes) ne sont jamais stock√©s en clair sur le serveur pour garantir la confidentialit√© totale en cas de fuite de donn√©es.</p>
            <ul>
                <li><strong>Algorithme</strong> : AES-256-CBC (Advanced Encryption Standard).</li>
                <li><strong>Cl√© Priv√©e</strong> : Stock√©e uniquement en variable d'environnement (<code>process.env.DOCUMENT_ENCRYPTION_KEY</code>), jamais sur Git.</li>
                <li><strong>Processus</strong> : Le fichier est chiffr√© "√† la vol√©e" (Stream) lors de l'upload. L'admin est le seul √† pouvoir demander un d√©chiffrement temporaire pour validation.</li>
            </ul>
        </div>
    </section>


    <!-- CHAPITRE 6 -->
    <section id="chapitre-6-deploy">
        <h2>Chapitre 6 : D√©ploiement & DevOps</h2>
        <div class="intro-block">
            <p>Une application moderne ne vit pas uniquement sur le poste du d√©veloppeur ("It works on my machine"). Nous avons pr√©par√© SociaLink pour un d√©ploiement robuste en production.</p>
        </div>

        <h3>6.1 Gestion des Variables d'Environnement (.env)</h3>
        <p>Les secrets (cl√©s API, mots de passe BDD) sont strictement s√©par√©s du code source via des fichiers <code>.env</code>. Cela permet de d√©ployer le m√™me code sur des environnements diff√©rents (Dev, Staging, Prod) en changeant simplement la configuration.</p>
        <pre><code class="language-bash">
# Exemple de .env (Backend)
PORT=5000
DATABASE_URL="postgresql://user:pass@supabase-host:5432/socialink_db"
JWT_SECRET="super_secret_key_complex_v6"
DOCUMENT_ENCRYPTION_KEY="32_bytes_random_hex_key_for_aes_256"
CLIENT_URL="https://socialink.ma"
        </code></pre>

        <h3>6.2 Processus de Build (Vite)</h3>
        <p>Contrairement au backend (Node.js) qui s'ex√©cute directement, le frontend React doit √™tre "transpil√©" et optimis√© pour le navigateur.</p>
        <ul class="feature-list">
            <li><strong>Optimisation</strong> : La commande <code>npm run build</code> (via Vite) g√©n√®re des fichiers HTML/CSS/JS minifi√©s dans le dossier <code>/dist</code>.</li>
            <li><strong>Cache Busting</strong> : Les fichiers JS g√©n√©r√©s ont des noms hach√©s (ex: <code>index.a1b2c3.js</code>) pour forcer le navigateur √† ret√©l√©charger la nouvelle version apr√®s une mise √† jour.</li>
        </ul>

        <h3>6.3 Architecture de D√©ploiement Cible</h3>
        <p>Pour la mise en production, nous recommandons l'architecture suivante :</p>
        <div class="mermaid">
        graph TD
            Client[Utilisateur] -->|HTTPS| Proxy[Nginx (Reverse Proxy)]
            Proxy -->|Static Files| Frontend[Frontend (React/Vite)]
            Proxy -->|/api| Backend[Backend (Node.js Cluster)]
            Backend --> DB[(Supabase PostgreSQL)]
            Backend --> S3[Stockage Fichiers (S3/Disk)]
        </div>
    </section>

    <!-- CONCLUSION -->
    <section id="conclusion">
        <h2 style="border-bottom: 3px solid var(--accent);">Conclusion G√©n√©rale</h2>
        <p>Le projet <strong>SociaLink v6.5</strong> d√©montre qu'une application de mise en relation peut √™tre √† la fois <strong>simple d'utilisation</strong> pour l'usager et <strong>techniquement rigoureuse</strong> en coulisses.</p>
        <p>De l'architecture modulaire √† la s√©curit√© avanc√©e (AES-256, RBAC), chaque choix technique a √©t√© fait pour garantir la p√©rennit√© et l'√©volutivit√© de la solution. Cette plateforme est pr√™te √† r√©pondre aux besoins r√©els du march√© marocain de l'interim et du service √† domicile.</p>
        <p style="margin-top: 2rem; font-style: italic;">D√©velopp√© avec ‚ù§Ô∏è et rigeur dans le cadre du projet de fin de formation.</p>
    </section>

    <footer style="margin-top: 4rem; text-align: center; border-top: 1px solid #ccc; padding-top: 2rem;">
        <p>G√©n√©r√© automatiquement pour le rapport de fin de formation SociaLink.</p>
    </footer>

</body>
</html>
